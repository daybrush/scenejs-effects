{"version":3,"file":"effects.min.js","sources":["../src/effects.ts"],"sourcesContent":["import { SceneItem, AnimatorState, Frame } from \"scenejs\";\nimport { IObject, isArray, splitUnit, dot } from \"@daybrush/utils\";\nimport { EffectState } from \"./types\";\n\n/**\n * @namespace Effects\n */\n\n/**\n * Use the property to create an effect.\n * @memberof Effects\n * @private\n * @param - property to set effect\n * @param - values of 100%\n * @example\n// import {set, blink} from \"@scenejs/effects\";\n// set(\"opacity\", [0, 1, 0], {duration: 2});\nScene.set(\"opacity\", [0, 1, 0], {duration: 2});\n\n// Same\nScene.blink({duration: 2});\n\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\topacity: 0,\n\t},\n\t\"50%\": {\n\t\topacity: 1,\n\t}\n\t\"100%\": {\n\t\topacity: 0,\n\t}\n}, {\n\tduration: 2,\n});\n */\nfunction set(property: string | string[], values: any[], options: Partial<AnimatorState>): SceneItem {\n    const item = new SceneItem({}, options);\n    const length = values.length;\n\n    for (let i = 0; i < length; ++i) {\n        item.set(`${i / (length - 1) * 100}%`, property, values[i]);\n    }\n    return item;\n}\n\n/**\n * Make a zoom in effect.\n * @memberof Effects\n * @param options\n * @param {number} [options.from = 0] start zoom\n * @param {number}[options.to = 1] end zoom\n * @param {number} options.duration animation's duration\n * @example\n// import {set, zoomIn} from \"@scenejs/effects\";\n// zoomIn({duration: 2});\nScene.zoomIn({duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\t\"transform\": \"scale(0)\",\n\t},\n\t\"100%\": {\n\t\t\"transform\": \"scale(1)\",\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function zoomIn({ from = 0, to = 1 }: Partial<EffectState>): SceneItem {\n    return set([\"transform\", \"scale\"], [from, to], arguments[0]);\n}\n\n/**\n * Make a zoom out effect.\n * @memberof Effects\n * @param options\n * @param {number} [options.from = 1] start zoom\n * @param {number}[options.to = 0] end zoom\n * @param {number} options.duration animation's duration\n * @example\n// import {zoomOut} from \"@scenejs/effects\";\n// zoomOut({duration: 2});\nScene.zoomOut({duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\t\"transform\": \"scale(1)\",\n\t},\n\t\"100%\": {\n\t\t\"transform\": \"scale(0)\",\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function zoomOut({ from = 1, to = 0 }: Partial<EffectState>): SceneItem {\n    return set([\"transform\", \"scale\"], [from, to], arguments[0]);\n}\n\n/**\n * Make a wipe in effect.\n * @memberof Effects\n * @param options\n * @param {string|string[]} [options.property = \"left\"] position property\n * @param {number|string} [options.from = \"-100%\"] start position\n * @param {number|string}[options.to = \"0%\"] end position\n * @param {number} options.duration animation's duration\n * @example\n// import {wipeIn} from \"@scenejs/effects\";\n// wipeIn({property: \"left\", duration: 2});\nScene.wipeIn({property: \"left\", duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\t\"left\": \"-100%\",\n\t},\n\t\"100%\": {\n\t\t\"left\": \"0%\",\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function wipeIn({ from = \"-100%\", to = \"0%\", property = \"left\" }: Partial<EffectState>): SceneItem {\n    return set(property, [from, to], arguments[0]);\n}\n\n/**\n * Make a wipe out effect.\n * @memberof Effects\n * @param options\n * @param {string|string[]} [options.property = \"left\"] position property\n * @param {number|string} [options.from = \"0%\"] start position\n * @param {number|string}[options.to = \"100%\"] end position\n * @param {number} options.duration animation's duration\n * @example\n// import {wipeOut} from \"@scenejs/effects\";\n// wipeOut({property: \"left\", duration: 2});\nScene.wipeOut({property: \"left\", duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\t\"left\": \"0%\",\n\t},\n\t\"100%\": {\n\t\t\"left\": \"100%\",\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function wipeOut({ from = \"0%\", to = \"100%\", property = \"left\" }: Partial<EffectState>): SceneItem {\n    return set(property, [from, to], arguments[0]);\n}\n\n/**\n * Switch the scene from `item1` to `item2`.\n * @memberof Effects\n * @param - Item that end effect\n * @param - Item that start effect\n * @param -  `transitionItem` or `transitionObject` to switch from `item1` to `item2`\n * @example\nimport Scene from \"scenejs\";\nimport {transition, zoomIn, fadeOut} from \"@scenejs/effects\";\n\nvar transitionScene = new Scene({\n  \"[data-transition] .target\": {},\n  \"[data-transition] .target2\": {},\n}, {\n  delay: 0.1,\n  easing: \"ease-in-out\",\n  selector: true,\n});\nScene.transition(\n  transitionScene.getItem(\"[data-transition] .target\"),\n  transitionScene.getItem(\"[data-transition] .target2\"),\n  {\n    0:  [\n      fadeOut({ duration: 1 }),\n      zoomIn({ from: 1, to: 2, duration: 1 }),\n      \"opacity: 1; transform: rotate(0deg)\",\n    ],\n    1: \"opacity: 0; transform: rotate(40deg)\",\n  }\n);\ntransitionScene.play();\n */\nexport function transition(\n    item1: SceneItem,\n    item2: SceneItem,\n    transitionObject: SceneItem | IObject<any>,\n): void {\n    const transitionItem = new SceneItem();\n\n    transitionItem.append(transitionObject);\n\n    const duration = transitionItem.getDuration();\n    const transitionTime = Math.max(item1.getDuration() - duration, 0);\n    item1.set({\n        [transitionTime]: transitionItem,\n    });\n    transitionItem.setDirection(\"reverse\");\n    item2.set({\n        0: transitionItem,\n    });\n}\n\n/**\n * Make a fade in effect.\n * @memberof Effects\n * @param options\n * @param {number} [options.from = 0] start opacity\n * @param {number}[options.to = 1] end opacity\n * @param {number} options.duration animation's duration\n * @example\n// import {fadeIn} from \"@scenejs/effects\";\n// fadeIn({duration: 2});\nScene.fadeIn({duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\topacity: 0,\n\t},\n\t\"100%\": {\n\t\topacity: 1,\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function fadeIn({ from = 0, to = 1 }: Partial<EffectState>): SceneItem {\n    return set(\"opacity\", [from, to], arguments[0]);\n}\n\n/**\n * Make a fade out effect.\n * @memberof Effects\n * @param options\n * @param {number} [options.from = 1] start opacity\n * @param {number}[options.to = 0] end opacity\n * @param {number} options.duration animation's duration\n * @example\n// import {fadeOut} from \"@scenejs/effects\";\n// fadeOut({duration: 2});\nScene.fadeOut({duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\topacity: 1,\n\t},\n\t\"100%\": {\n\t\topacity: 0,\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function fadeOut({ from = 1, to = 0 }: Partial<EffectState> = {}): SceneItem {\n    return set(\"opacity\", [from, to], arguments[0]);\n}\n/**\n * Make a blinking effect.\n * @memberof Effects\n * @param options\n * @param {number} [options.from = 0] start opacity\n * @param {number}[options.to = 1] end opacity\n * @param {number} options.duration animation's duration\n * @example\n// import {blink} from \"@scenejs/effects\";\n// blink({duration: 2});\nScene.blink({duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\topacity: 0,\n\t},\n\t\"50%\": {\n\t\topacity: 1,\n\t},\n\t\"100%\": {\n\t\topacity: 0,\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function blink({ from = 0, to = 1 }: Partial<EffectState> = {}): SceneItem {\n    return set(\"opacity\", [from, to, from], arguments[0]);\n}\nexport function flip({\n    x = 1,\n    y = 0,\n    backside = false,\n  }: Partial<EffectState> = {}) {\n    const item = new SceneItem({}, arguments[0]);\n    let property = \"\";\n    let startValue = \"\";\n    let endValue = \"\";\n    const ratio = (x && y) || x ? x : y;\n    const startDeg = (backside ? ( ratio > 0 ? 180 : -180) : 0);\n    const endDeg = startDeg + ratio * 180;\n\n    if (x && y) {\n      const axis = [x > 0 ? 1 : -1, y > 0 ? 1 : -1, 0 , \"\"].join(\",\");\n\n      property = \"rotate3d\";\n      startValue = axis + startDeg + \"deg\";\n      endValue = axis + endDeg + \"deg\";\n    } else {\n      if (x) {\n        property = \"rotateX\";\n      } else if (y) {\n        property = \"rotateY\";\n      } else {\n        return item;\n      }\n      startValue = startDeg + \"deg\";\n      endValue = endDeg + \"deg\";\n    }\n    item.set({\n      transform: {\n        [property]: [startValue, endValue],\n      },\n    });\n    return item;\n  }\nexport function flipX({\n    x = 1,\n    backside = false,\n}: Partial<EffectState> = {}): SceneItem {\n    const item = flip({ x, backside });\n\n    item.setOptions(arguments[0]);\n\n    return item;\n}\nexport function flipY({\n    y = 1,\n    backside = false,\n}: Partial<EffectState> = {}): SceneItem {\n    const item = flip({ x: 0, y, backside });\n\n    item.setOptions(arguments[0]);\n    return item;\n}\nexport function shake({\n    properties = {\n        transform: {\n            translateX: [`-5px`, `5px`],\n            translateY: [`-5px`, `5px`],\n            rotate: [`-5deg`, `5deg`],\n        },\n    },\n    interval = 10,\n}: Partial<EffectState> = {}): SceneItem {\n    const item = new SceneItem({}, arguments[0]);\n    const frame = new Frame(properties);\n    const names = frame.getNames();\n\n    names.forEach((propertyNames, i) => {\n        const value = frame.get(...propertyNames);\n        let start: number = 0;\n        let end: number = 0;\n        let unit: string = \"\";\n\n        if (isArray(value)) {\n            const {value: startNumber, unit: startUnit} = splitUnit(value[0]);\n\n            unit = startUnit;\n            start = startNumber;\n            end = splitUnit(value[1]).value;\n        } else {\n            const {value: valueNumber, unit: valueUnit} = splitUnit(value);\n\n            unit = valueUnit;\n            end = Math.abs(valueNumber);\n            start = -end;\n        }\n        item.set(`0%`, ...propertyNames, `${start + end}${unit}`);\n        item.set(`100%`, ...propertyNames, `${start + end}${unit}`);\n        for (let j = 1; j < interval - 1; ++j) {\n            const ratio = Math.random() * (end - start) + start;\n            const result = dot(start, end, ratio + 1, 1 - ratio) * (i % 2 ? -1 : 1);\n\n            item.set(`${j / (interval - 1) * 100}%`, ...propertyNames, `${result}${unit}`);\n        }\n    });\n    return item;\n}\n"],"names":["set","property","values","options","item","SceneItem","length","i","flip","_a","_c","_d","x","_e","y","_f","backside","startValue","endValue","ratio","startDeg","endDeg","axis","join","transform","_b","from","setOptions","properties","interval","frame","Frame","getNames","forEach","propertyNames","value","get","start","end","unit","isArray","startNumber","splitUnit","valueNumber","Math","abs","j","random","result","dot","item1","item2","transitionObject","transitionItem","append","duration","getDuration","transitionTime","max","setDirection","to"],"mappings":"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"}