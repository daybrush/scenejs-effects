{"version":3,"file":"effects.min.js","sources":["../src/effects.ts"],"sourcesContent":["import { SceneItem, AnimatorState, Frame } from \"scenejs\";\nimport { IObject, isArray, splitUnit, dot } from \"@daybrush/utils\";\nimport { EffectState } from \"./types\";\n\n/**\n * @namespace Effects\n */\n\n/**\n * Use the property to create an effect.\n * @memberof Effects\n * @private\n * @param - property to set effect\n * @param - values of 100%\n * @example\n// import {set, blink} from \"@scenejs/effects\";\n// set(\"opacity\", [0, 1, 0], {duration: 2});\nScene.set(\"opacity\", [0, 1, 0], {duration: 2});\n\n// Same\nScene.blink({duration: 2});\n\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\topacity: 0,\n\t},\n\t\"50%\": {\n\t\topacity: 1,\n\t}\n\t\"100%\": {\n\t\topacity: 0,\n\t}\n}, {\n\tduration: 2,\n});\n */\nfunction set(property: string | string[], values: any[], options: Partial<AnimatorState>): SceneItem {\n    const item = new SceneItem({}, options);\n    const length = values.length;\n\n    for (let i = 0; i < length; ++i) {\n        item.set(`${i / (length - 1) * 100}%`, property, values[i]);\n    }\n    return item;\n}\n\n/**\n * Make a zoom in effect.\n * @memberof Effects\n * @param options\n * @param {number} [options.from = 0] start zoom\n * @param {number}[options.to = 1] end zoom\n * @param {number} options.duration animation's duration\n * @example\n// import {set, zoomIn} from \"@scenejs/effects\";\n// zoomIn({duration: 2});\nScene.zoomIn({duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\t\"transform\": \"scale(0)\",\n\t},\n\t\"100%\": {\n\t\t\"transform\": \"scale(1)\",\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function zoomIn({ from = 0, to = 1 }: Partial<EffectState>): SceneItem {\n    return set([\"transform\", \"scale\"], [from, to], arguments[0]);\n}\n\n/**\n * Make a zoom out effect.\n * @memberof Effects\n * @param options\n * @param {number} [options.from = 1] start zoom\n * @param {number}[options.to = 0] end zoom\n * @param {number} options.duration animation's duration\n * @example\n// import {zoomOut} from \"@scenejs/effects\";\n// zoomOut({duration: 2});\nScene.zoomOut({duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\t\"transform\": \"scale(1)\",\n\t},\n\t\"100%\": {\n\t\t\"transform\": \"scale(0)\",\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function zoomOut({ from = 1, to = 0 }: Partial<EffectState>): SceneItem {\n    return set([\"transform\", \"scale\"], [from, to], arguments[0]);\n}\n\n/**\n * Make a wipe in effect.\n * @memberof Effects\n * @param options\n * @param {string|string[]} [options.property = \"left\"] position property\n * @param {number|string} [options.from = \"-100%\"] start position\n * @param {number|string}[options.to = \"0%\"] end position\n * @param {number} options.duration animation's duration\n * @example\n// import {wipeIn} from \"@scenejs/effects\";\n// wipeIn({property: \"left\", duration: 2});\nScene.wipeIn({property: \"left\", duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\t\"left\": \"-100%\",\n\t},\n\t\"100%\": {\n\t\t\"left\": \"0%\",\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function wipeIn({ from = \"-100%\", to = \"0%\", property = \"left\" }: Partial<EffectState>): SceneItem {\n    return set(property, [from, to], arguments[0]);\n}\n\n/**\n * Make a wipe out effect.\n * @memberof Effects\n * @param options\n * @param {string|string[]} [options.property = \"left\"] position property\n * @param {number|string} [options.from = \"0%\"] start position\n * @param {number|string}[options.to = \"100%\"] end position\n * @param {number} options.duration animation's duration\n * @example\n// import {wipeOut} from \"@scenejs/effects\";\n// wipeOut({property: \"left\", duration: 2});\nScene.wipeOut({property: \"left\", duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\t\"left\": \"0%\",\n\t},\n\t\"100%\": {\n\t\t\"left\": \"100%\",\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function wipeOut({ from = \"0%\", to = \"100%\", property = \"left\" }: Partial<EffectState>): SceneItem {\n    return set(property, [from, to], arguments[0]);\n}\n\n/**\n * Switch the scene from `item1` to `item2`.\n * @memberof Effects\n * @param - Item that end effect\n * @param - Item that start effect\n * @param -  `transitionItem` or `transitionObject` to switch from `item1` to `item2`\n * @example\nimport Scene from \"scenejs\";\nimport {transition, zoomIn, fadeOut} from \"@scenejs/effects\";\n\nvar transitionScene = new Scene({\n  \"[data-transition] .target\": {},\n  \"[data-transition] .target2\": {},\n}, {\n  delay: 0.1,\n  easing: \"ease-in-out\",\n  selector: true,\n});\nScene.transition(\n  transitionScene.getItem(\"[data-transition] .target\"),\n  transitionScene.getItem(\"[data-transition] .target2\"),\n  {\n    0:  [\n      fadeOut({ duration: 1 }),\n      zoomIn({ from: 1, to: 2, duration: 1 }),\n      \"opacity: 1; transform: rotate(0deg)\",\n    ],\n    1: \"opacity: 0; transform: rotate(40deg)\",\n  }\n);\ntransitionScene.play();\n */\nexport function transition(\n    item1: SceneItem,\n    item2: SceneItem,\n    transitionObject: SceneItem | IObject<any>,\n): void {\n    const transitionItem = new SceneItem();\n\n    transitionItem.append(transitionObject);\n\n    const duration = transitionItem.getDuration();\n    const transitionTime = Math.max(item1.getDuration() - duration, 0);\n    item1.set({\n        [transitionTime]: transitionItem,\n    });\n    transitionItem.setDirection(\"reverse\");\n    item2.set({\n        0: transitionItem,\n    });\n}\n\n/**\n * Make a fade in effect.\n * @memberof Effects\n * @param options\n * @param {number} [options.from = 0] start opacity\n * @param {number}[options.to = 1] end opacity\n * @param {number} options.duration animation's duration\n * @example\n// import {fadeIn} from \"@scenejs/effects\";\n// fadeIn({duration: 2});\nScene.fadeIn({duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\topacity: 0,\n\t},\n\t\"100%\": {\n\t\topacity: 1,\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function fadeIn({ from = 0, to = 1 }: Partial<EffectState>): SceneItem {\n    return set(\"opacity\", [from, to], arguments[0]);\n}\n\n/**\n * Make a fade out effect.\n * @memberof Effects\n * @param options\n * @param {number} [options.from = 1] start opacity\n * @param {number}[options.to = 0] end opacity\n * @param {number} options.duration animation's duration\n * @example\n// import {fadeOut} from \"@scenejs/effects\";\n// fadeOut({duration: 2});\nScene.fadeOut({duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\topacity: 1,\n\t},\n\t\"100%\": {\n\t\topacity: 0,\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function fadeOut({ from = 1, to = 0 }: Partial<EffectState>): SceneItem {\n    return set(\"opacity\", [from, to], arguments[0]);\n}\n/**\n * Make a blinking effect.\n * @memberof Effects\n * @param options\n * @param {number} [options.from = 0] start opacity\n * @param {number}[options.to = 1] end opacity\n * @param {number} options.duration animation's duration\n * @example\n// import {blink} from \"@scenejs/effects\";\n// blink({duration: 2});\nScene.blink({duration: 2});\n// Same\nnew SceneItem({\n\t\"0%\": {\n\t\topacity: 0,\n\t},\n\t\"50%\": {\n\t\topacity: 1,\n\t},\n\t\"100%\": {\n\t\topacity: 0,\n\t}\n}, {\n\tduration: 2,\n});\n */\nexport function blink({ from = 0, to = 1 }: Partial<EffectState>): SceneItem {\n    return set(\"opacity\", [from, to, from], arguments[0]);\n}\n\nexport function shake({\n    properties = {\n        transform: {\n            translateX: [`-10px`, `10px`],\n            translateY: [`-10px`, `10px`],\n            rotate: [`-10deg`, `10deg`],\n        },\n    },\n}: Partial<EffectState>): SceneItem {\n    const item = new SceneItem({}, arguments[0]);\n    const frame = new Frame(properties);\n    const names = frame.getNames();\n    const preset = [-1, 0.5, -0.5, 1, -0.5, 0.5, -1];\n    const length = preset.length;\n\n    names.forEach(propertyNames => {\n        const value = frame.get(...propertyNames);\n        let start: number = 0;\n        let end: number = 0;\n        let unit: string = \"\";\n\n        if (isArray(value)) {\n            const {value: startNumber, unit: startUnit} = splitUnit(value[0]);\n\n            unit = startUnit;\n            start = startNumber;\n            end = splitUnit(value[1]).value;\n        } else {\n            const {value: valueNumber, unit: valueUnit} = splitUnit(value);\n\n            unit = valueUnit;\n            end = Math.abs(valueNumber);\n            start = -end;\n        }\n        [-1, 0.5, -0.5, 1, -0.5, 0.5, -1].map((ratio, i) => {\n            const result = dot(start, end, ratio + 1, 1 - ratio);\n\n            for (let i = 0; i < length; ++i) {\n                item.set(`${i / (length - 1) * 100}%`, ...propertyNames, `${result}${unit}`);\n            }\n        });\n    });\n    return item;\n}\n"],"names":["set","property","values","options","item","SceneItem","length","i","_a","_b","from","_c","properties","frame","Frame","names","getNames","forEach","propertyNames","value","get","start","end","unit","isArray","startNumber","startUnit","splitUnit","valueNumber","valueUnit","Math","abs","map","ratio","result","dot","i_1","item1","item2","transitionObject","transitionItem","append","duration","getDuration","transitionTime","max","setDirection","to","_d"],"mappings":";;;;;;;;ySAqCA,SAASA,EAAIC,EAA6BC,EAAeC,WAC/CC,EAAO,IAAIC,YAAU,GAAIF,GACzBG,EAASJ,EAAOI,OAEbC,EAAI,EAAGA,EAAID,IAAUC,EAC1BH,EAAKJ,IAAOO,GAAKD,EAAS,GAAK,QAAQL,EAAUC,EAAOK,WAErDH,mBAoPWI,OAAEC,SAAAC,iBAAUC,cACvBX,EAAI,UAAW,CAACU,iBAAUA,GADfF,sBAxDCA,OAAEC,SAAAC,iBAAUC,cACxBX,EAAI,UAAW,CAACU,kBADJF,uBA2BCA,OAAEC,SAAAC,iBAAUC,cACzBX,EAAI,UAAW,CAACU,kBADHF,qBAiCFA,OAClBC,eAAAG,+GAQMR,EAAO,IAAIC,YAAU,GATTG,GAUZK,EAAQ,IAAIC,QAAMF,GAClBG,EAAQF,EAAMG,WAEdV,EADS,EAAE,EAAG,IAAM,GAAK,GAAI,GAAK,IAAM,GACxBA,cAEtBS,EAAME,QAAQ,SAAAC,OACJC,EAAQN,EAAMO,UAANP,EAAaK,GACvBG,EAAgB,EAChBC,EAAc,EACdC,EAAe,MAEfC,UAAQL,GAAQ,KACVX,oBAACiB,UAAoBC,SAE3BH,EAAOG,EACPL,EAAQI,EACRH,EAAMK,YAAUR,EAAM,IAAIA,UACvB,KACGV,iBAACmB,UAAoBC,SAE3BN,EAAOM,EACPP,EAAMQ,KAAKC,IAAIH,GACfP,GAASC,IAEX,EAAG,IAAM,GAAK,GAAI,GAAK,IAAM,GAAGU,IAAI,SAACC,EAAO1B,WACpC2B,EAASC,MAAId,EAAOC,EAAKW,EAAQ,EAAG,EAAIA,GAErCG,EAAI,EAAGA,EAAI9B,IAAU8B,EAC1BhC,EAAKJ,UAALI,GAAYgC,GAAK9B,EAAS,GAAK,gBAAWY,GAAe,GAAGgB,EAASX,SAI1EnB,yBAhJPiC,EACAC,EACAC,SAEMC,EAAiB,IAAInC,YAE3BmC,EAAeC,OAAOF,OAEhBG,EAAWF,EAAeG,cAC1BC,EAAiBd,KAAKe,IAAIR,EAAMM,cAAgBD,EAAU,GAChEL,EAAMrC,YACD4C,GAAiBJ,MAEtBA,EAAeM,aAAa,WAC5BR,EAAMtC,IAAI,GACHwC,uBAhFYhC,OAAEC,SAAAC,uBAAgBC,OAAAoC,oBAAWC,oBACzChD,sBAAc,CAACU,EAAMqC,GADTvC,uBA4BCA,OAAEC,SAAAC,oBAAaC,OAAAoC,sBAAaC,oBACzChD,sBAAc,CAACU,EAAMqC,GADRvC,sBAnFDA,OAAEC,SAAAC,iBAAUC,cACxBX,EAAI,CAAC,YAAa,SAAU,CAACU,kBADjBF,uBA2BCA,OAAEC,SAAAC,iBAAUC,cACzBX,EAAI,CAAC,YAAa,SAAU,CAACU,kBADhBF"}